{% extends "base.html" %}
{% block content %}

<div class="dashboard-container">

  <div class="hero-card">
    <h1>Welcome to FlashLearn</h1>
    <p>Your personal flashcard and quiz platform for effective learning</p>
    <a href="/flashcards" class="btn-start">Start Learning</a>
  </div>

  <div class="stats-cards">
    <div class="stat-card">
      <h3>Total Flashcards</h3>
      <p>{{ count }}</p>
    </div>
    <div class="stat-card">
      <h3>Quizzes Available</h3>
      <p>5</p>
    </div>
  </div>

  <div class="overall-stats">
    <div class="overall-card">
      <h4>Total Quiz Attempts</h4>
      <p id="totalAttempts">0</p>
    </div>
    <div class="overall-card">
      <h4>Best Overall Score</h4>
      <p id="bestOverall">0</p>
    </div>
    <div class="overall-card">
      <h4>Strongest Category</h4>
      <p id="strongestCat">-</p>
    </div>
    <div class="overall-card">
      <h4>Weakest Category</h4>
      <p id="weakestCat">-</p>
    </div>
  </div>

  <div class="progress-section">
    <h2>Your Quiz Progress</h2>
    <div id="progressCards" class="progress-cards">
      <p class="muted">No quiz attempts yet. Start a quiz to see progress.</p>
    </div>
  </div>
</div>

<script>
const container = document.getElementById("progressCards");
const progress = JSON.parse(localStorage.getItem("quizProgress")) || {};
const categories = Object.keys(progress);

if (categories.length > 0) {
  container.innerHTML = "";
  categories.forEach(cat => {
    const data = progress[cat];
    const card = document.createElement("div");
    card.className = "progress-card";
    card.innerHTML = `
      <h3>${cat}</h3>
      <p>Attempts: ${data.attempts}</p>
      <p>Best Score: ${data.best}</p>
      <p>Last Score: ${data.last}</p>
    `;
    container.appendChild(card);
  });
}

const progressData = JSON.parse(localStorage.getItem("quizProgress")) || {};

let totalAttempts = 0;
let bestOverall = 0;
let strongest = "-";
let weakest = "-";

const cats = Object.keys(progressData);

if (cats.length > 0) {
  strongest = cats[0];
  weakest = cats[0];

  cats.forEach(cat => {
    const d = progressData[cat];
    totalAttempts += d.attempts;
    bestOverall = Math.max(bestOverall, d.best);

    if (d.best > progressData[strongest].best) strongest = cat;
    if (d.best < progressData[weakest].best) weakest = cat;
  });
}

document.getElementById("totalAttempts").innerText = totalAttempts;
document.getElementById("bestOverall").innerText = bestOverall;
document.getElementById("strongestCat").innerText = strongest;
document.getElementById("weakestCat").innerText = weakest;
</script>

{% endblock %}